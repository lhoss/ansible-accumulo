---
- name: Create service account for Accumulo
  user: name={{ accumulo_user }}
        system=yes
        home={{ accumulo_user_dir }}
        shell={{ accumulo_user_shell }}
        state=present

- include: accumulo-distr.yml

# TODO check the 'logs' dir makes sense
- name: Ensure Accumulo directories are owned by Accumulo user
  file: path={{ item }}
        owner={{ accumulo_user }}
        mode=0755
        state=directory
  with_items:
    - "{{ accumulo_log_dir }}/logs"
# below one is a symlink in the new 'distr' setup
#    - "{{ accumulo_conf_dir }}"

- name: Configure Accumulo service definitions
  template: src=services/accumulo-upstart-template.conf.j2
            dest=/etc/init/accumulo-{{ item.name }}.conf
            mode=0644
  with_items:
    - { name: "gc"}
    - { name: "master"}
    - { name: "monitor", args: "--address 0.0.0.0" }
    - { name: "tracer"}
    - { name: "tserver"}
